
&НаКлиенте
Процедура СделатьФото(Команда)
	#Если МобильноеПриложениеКлиент Тогда
		ДанныеМультимедиа = СредстваМультимедиа.СделатьФотоснимок();
		Если ДанныеМультимедиа <> Неопределено Тогда
			рез=СоздатьНовыйФайлСервер(ДанныеМультимедиа.ПолучитьДвоичныеДанные(),ДанныеМультимедиа.РасширениеФайла,ДанныеМультимедиа.ТипСодержимого);
		КонецЕсли;
		сообщить(рез);
	#КонецЕсли
КонецПроцедуры

&НаСервере
function СоздатьНовыйФайлСервер(Данные, Расширение, Тип)
	ТипСодержимого = Тип;
	Номер = Найти(ТипСодержимого, "/");
	Если Номер > 0 Тогда
		ТипСодержимого = Лев(ТипСодержимого, Номер - 1);
	КонецЕсли;
	
	Файл = Новый Файл(СтрЗаменить(Строка(ТекущаяДата()), ":", "_") + "." + Расширение);
	
	ХранимыйФайл = Справочники.ИзображенияЗаказов.СоздатьЭлемент();
	//ХранимыйФайл.Владелец = Объект.Ссылка;
	ХранимыйФайл.Наименование = ТипСодержимого + " " + Строка(ТекущаяДата());
	ХранимыйФайл.ДанныеФайла = Новый ХранилищеЗначения(Данные, Новый СжатиеДанных(9));
	ХранимыйФайл.Дата=ТекущаяДата();
	ХранимыйФайл.Записать();
	return ХранимыйФайл.Наименование;
endfunction

&НаКлиенте
Процедура Post(Команда)
	рез=POSTЗапрос("параметр");
	Сообщить(рез);
КонецПроцедуры

Функция POSTЗапрос(ПараметрЗапроса)
	//http://192.168.200.128/hs/hs/test
	ИмяОпубликованнойБазы="sc";
      Попытка
          //подключение к этому ПК
          Соединение = Новый HTTPСоединение("localhost:8000/",,"os","15");
      Исключение
          Возврат "Ошибка при создании HTTP соединения.";
      КонецПопытки;
               
      //HTTPЗапрос = Новый HTTPЗапрос(ИмяОпубликованнойБазы+"/hs/test");
	  HTTPЗапрос = Новый HTTPЗапрос(ИмяОпубликованнойБазы+"/hs/exchange/query");

      HTTPЗапрос.УстановитьТелоИзСтроки(ПараметрЗапроса);
               
      Ответ = "";
               
      Попытка
          HTTPОтвет =     Соединение.Записать(HTTPЗапрос);
          Ответ = HTTPОтвет.ПолучитьТелоКакСтроку();
      Исключение
          Возврат "Ошибка при соединении.";
      КонецПопытки;
               
      Возврат Ответ;
КонецФункции
